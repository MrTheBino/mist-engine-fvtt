<div class="themebook-container container-themebook-with-border" data-id="{{id}}">
    <div class="themebook-style {{themebook.system.type}} flexcol">
        <h2 class="theme-name">{{themebook.name}}
            {{#if editMode}}
            <a data-action="editItem" data-item-id='{{themebook._id}}'>
                <i class='fas fa-edit'></i>
            </a>
            <a data-action="deleteItem" data-item-id='{{themebook._id}}'>
                <i class='fas fa-trash'></i>
            </a>
            {{else}}
            <i class="themebook-icon {{themebook.system.type}}"></i>
            {{/if}}
        </h2>
        <div class="powertags-container">
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-powertag-line.hbs" index=1 id=themebook._id
            powertag=themebook.system.powertag1 editMode=editMode firstTag=true}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-powertag-line.hbs" index=2 id=themebook._id
            powertag=themebook.system.powertag2 editMode=editMode}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-powertag-line.hbs" index=3 id=themebook._id
            powertag=themebook.system.powertag3 editMode=editMode}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-powertag-line.hbs" index=4 id=themebook._id
            powertag=themebook.system.powertag4 editMode=editMode}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-powertag-line.hbs" index=5 id=themebook._id
            powertag=themebook.system.powertag5 editMode=editMode}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-powertag-line.hbs" index=6 id=themebook._id
            powertag=themebook.system.powertag6 editMode=editMode}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-powertag-line.hbs" index=7 id=themebook._id
            powertag=themebook.system.powertag7 editMode=editMode}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-powertag-line.hbs" index=8 id=themebook._id
            powertag=themebook.system.powertag8 editMode=editMode}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-powertag-line.hbs" index=9 id=themebook._id
            powertag=themebook.system.powertag9 editMode=editMode}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-powertag-line.hbs" index=10 id=themebook._id
            powertag=themebook.system.powertag10 editMode=editMode}}

            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-weakness-line.hbs" index=1 id=themebook._id
            weaknesstag=themebook.system.weaknesstag1 editMode=editMode}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-weakness-line.hbs" index=2 id=themebook._id
            weaknesstag=themebook.system.weaknesstag2 editMode=editMode}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-weakness-line.hbs" index=3 id=themebook._id
            weaknesstag=themebook.system.weaknesstag3 editMode=editMode}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-weakness-line.hbs" index=4 id=themebook._id
            weaknesstag=themebook.system.weaknesstag4 editMode=editMode}}

            {{#if themebook.system.hasSpecialImprovements}}
            <h3 class="special-improvement-section-label">{{localize 'MIST_ENGINE.LABELS.SpecialImprovements'}}</h3>
            {{/if}}
            {{#each themebook.system.specialImprovements as |specialImprovement index|}}
            {{#if (notEmpty specialImprovement.name)}}
            {{> "systems/mist-engine-fvtt/templates/shared/litm/themebook-special-improvement-line.hbs" index=index
            id=../themebook._id
            specialImprovement=specialImprovement editMode=../editMode}}
            {{/if}}
            {{/each}}

        </div>
        <div class="quest-container">
            {{#if editMode}}
            <textarea class="item-editable-stat quest-textarea" data-item-id={{themebook._id}}
                data-item-stat="system.quest"
                placeholder="{{localize 'MIST_ENGINE.PLACEHOLDERS.QuestGoal'}}">{{themebook.system.quest}}</textarea>
            <textarea class="item-editable-stat quest-textarea" data-item-id={{themebook._id}}
                data-item-stat="system.story"
                placeholder="{{localize 'MIST_ENGINE.PLACEHOLDERS.ThemebookStory'}}">{{themebook.system.story}}</textarea>
            {{else}}
            <h3>{{localize 'MIST_ENGINE.LABELS.Quest'}}</h3>
            <p class="quest-text" data-tooltip="{{themebook.system.story}}" data-tooltip-direction="DOWN">{{themebook.system.quest}}</p>
            {{/if}}
        </div>
        <div class="development-container flexrow">
            {{> "systems/mist-engine-fvtt/templates/actor/parts/development-partial.hbs" name=(localize
            'MIST_ENGINE.LABELS.Abandon') id=themebook._id key="system.abandon" value=themebook.system.abandon}}
            {{> "systems/mist-engine-fvtt/templates/actor/parts/development-partial.hbs" name=(localize
            'MIST_ENGINE.LABELS.Improve') id=themebook._id key="system.improve" value=themebook.system.improve}}
            {{> "systems/mist-engine-fvtt/templates/actor/parts/development-partial.hbs" name=(localize
            'MIST_ENGINE.LABELS.Milestone') id=themebook._id key="system.milestone" value=themebook.system.milestone}}
        </div>
    </div>
</div>